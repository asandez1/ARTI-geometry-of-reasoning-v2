{
  "experiment": "E11_break_uniform_attention",
  "description": "E11: 4 fixes to break uniform anchor attention (entropy anneal, xavier proj, ortho anchors, 0.05 U/V)",
  "seeds": [
    42,
    123,
    7
  ],
  "device": "cuda",
  "fixes": [
    "Trainer delegates entropy weight to model._get_effective_lambda_entropy()",
    "manifold_proj: xavier_normal(gain=2.0) init",
    "anchors: orthogonal QR init (unit-norm, max separation)",
    "U_all/V_all: 0.05 scale (was 0.01)"
  ],
  "e10_baselines": {
    "gsm8k": {
      "mean": 0.474,
      "std": 0.033
    },
    "arc_challenge": {
      "mean": 0.281,
      "std": 0.003
    },
    "strategyqa": {
      "mean": 0.492,
      "std": 0.023
    },
    "folio": {
      "mean": 0.33,
      "std": 0.01
    }
  },
  "per_seed": {
    "42": {
      "gsm8k": {
        "n_examples": 1319,
        "n_choices": 4,
        "random_baseline": 0.25,
        "accuracy": 0.4450341167551175,
        "lift_over_random": 0.1950341167551175,
        "anchor_entropy_mean": 2.7629318237304688,
        "anchor_entropy_std": 0.004280400928109884,
        "anchor_entropy_ratio": 0.9965170101025618,
        "max_anchor_weight_mean": 0.0788312703371048,
        "max_anchor_weight_std": 0.004504959564656019,
        "per_anchor_mean_weight": [
          0.06402753293514252,
          0.0668884664773941,
          0.06159772351384163,
          0.05879010260105133,
          0.06313761323690414,
          0.059962812811136246,
          0.060748640447854996,
          0.06344378739595413,
          0.06334749609231949,
          0.06100406497716904,
          0.061178095638751984,
          0.0637889876961708,
          0.06212194263935089,
          0.06278494000434875,
          0.06625743955373764,
          0.06092038378119469
        ],
        "anchor_weight_gini": 0.01864994317293167
      },
      "arc_challenge": {
        "n_examples": 1172,
        "n_choices": 4,
        "random_baseline": 0.25,
        "accuracy": 0.28668941979522183,
        "lift_over_random": 0.036689419795221834,
        "anchor_entropy_mean": 2.760465145111084,
        "anchor_entropy_std": 0.0031471820548176765,
        "anchor_entropy_ratio": 0.9956273438496485,
        "max_anchor_weight_mean": 0.07890357822179794,
        "max_anchor_weight_std": 0.003369202371686697,
        "per_anchor_mean_weight": [
          0.04988716170191765,
          0.05386152118444443,
          0.056967973709106445,
          0.07383696734905243,
          0.07089021801948547,
          0.056700073182582855,
          0.05577331408858299,
          0.07426479458808899,
          0.05390818044543266,
          0.05737851560115814,
          0.06344882398843765,
          0.07676523923873901,
          0.06964350491762161,
          0.05606381967663765,
          0.07419030368328094,
          0.05641959235072136
        ],
        "anchor_weight_gini": 0.07779069757089019
      },
      "strategyqa": {
        "n_examples": 1603,
        "n_choices": 2,
        "random_baseline": 0.5,
        "accuracy": 0.495321272613849,
        "lift_over_random": -0.004678727386150994,
        "anchor_entropy_mean": 2.760756254196167,
        "anchor_entropy_std": 0.0023976911325007677,
        "anchor_entropy_ratio": 0.9957323392580002,
        "max_anchor_weight_mean": 0.07857025414705276,
        "max_anchor_weight_std": 0.0028113401494920254,
        "per_anchor_mean_weight": [
          0.049425192177295685,
          0.05436841771006584,
          0.061128661036491394,
          0.07214478403329849,
          0.0698784589767456,
          0.05564648658037186,
          0.05569228529930115,
          0.07532352954149246,
          0.05314728245139122,
          0.05687551200389862,
          0.06536104530096054,
          0.07717838883399963,
          0.0694965049624443,
          0.05642573535442352,
          0.07391390949487686,
          0.05399380624294281
        ],
        "anchor_weight_gini": 0.08021259866654873
      },
      "folio": {
        "n_examples": 203,
        "n_choices": 3,
        "random_baseline": 0.3333333333333333,
        "accuracy": 0.35467980295566504,
        "lift_over_random": 0.02134646962233172,
        "anchor_entropy_mean": 2.760916233062744,
        "anchor_entropy_std": 0.0028148747514933348,
        "anchor_entropy_ratio": 0.9957900394373647,
        "max_anchor_weight_mean": 0.07832972705364227,
        "max_anchor_weight_std": 0.0032290066592395306,
        "per_anchor_mean_weight": [
          0.04927150905132294,
          0.05350283160805702,
          0.05942300334572792,
          0.07215003669261932,
          0.06972043961286545,
          0.05642460286617279,
          0.05648232623934746,
          0.07513059675693512,
          0.053617823868989944,
          0.057916030287742615,
          0.0662013366818428,
          0.07637659460306168,
          0.07065608352422714,
          0.05532658472657204,
          0.07250669598579407,
          0.055293478071689606
        ],
        "anchor_weight_gini": 0.07822956796735525
      }
    },
    "123": {
      "gsm8k": {
        "n_examples": 1319,
        "n_choices": 4,
        "random_baseline": 0.25,
        "accuracy": 0.5049279757391963,
        "lift_over_random": 0.25492797573919634,
        "anchor_entropy_mean": 2.763300657272339,
        "anchor_entropy_std": 0.003558679251000285,
        "anchor_entropy_ratio": 0.9966500386830042,
        "max_anchor_weight_mean": 0.07935721427202225,
        "max_anchor_weight_std": 0.004403413739055395,
        "per_anchor_mean_weight": [
          0.060149990022182465,
          0.0658063068985939,
          0.06179271638393402,
          0.060276709496974945,
          0.06242453306913376,
          0.06563897430896759,
          0.06246541440486908,
          0.0632549449801445,
          0.06116100773215294,
          0.06568470597267151,
          0.0608270987868309,
          0.06149858981370926,
          0.06175924837589264,
          0.06319958716630936,
          0.06328204274177551,
          0.06077812984585762
        ],
        "anchor_weight_gini": 0.016039084643125534
      },
      "arc_challenge": {
        "n_examples": 1172,
        "n_choices": 4,
        "random_baseline": 0.25,
        "accuracy": 0.28668941979522183,
        "lift_over_random": 0.036689419795221834,
        "anchor_entropy_mean": 2.759561777114868,
        "anchor_entropy_std": 0.0013318212004378438,
        "anchor_entropy_ratio": 0.9953015227175889,
        "max_anchor_weight_mean": 0.08222561329603195,
        "max_anchor_weight_std": 0.001676718587987125,
        "per_anchor_mean_weight": [
          0.05813886225223541,
          0.05664950609207153,
          0.06031641736626625,
          0.054396409541368484,
          0.06270097941160202,
          0.04800530523061752,
          0.06964358687400818,
          0.07250373065471649,
          0.06445914506912231,
          0.04430263489484787,
          0.06019322946667671,
          0.07338564097881317,
          0.06400570273399353,
          0.07546035200357437,
          0.05377067252993584,
          0.08206783980131149
        ],
        "anchor_weight_gini": 0.0899066524580121
      },
      "strategyqa": {
        "n_examples": 1603,
        "n_choices": 2,
        "random_baseline": 0.5,
        "accuracy": 0.46350592638802246,
        "lift_over_random": -0.03649407361197754,
        "anchor_entropy_mean": 2.7601430416107178,
        "anchor_entropy_std": 0.0011757082538679242,
        "anchor_entropy_ratio": 0.9955111695689907,
        "max_anchor_weight_mean": 0.08152730017900467,
        "max_anchor_weight_std": 0.0015711793676018715,
        "per_anchor_mean_weight": [
          0.0577995590865612,
          0.057028237730264664,
          0.06097496300935745,
          0.05423529073596001,
          0.06378024816513062,
          0.04844041168689728,
          0.06969450414180756,
          0.07195783406496048,
          0.06467831134796143,
          0.04446500912308693,
          0.059235796332359314,
          0.0727330893278122,
          0.06357834488153458,
          0.07598944008350372,
          0.05388570949435234,
          0.08152322471141815
        ],
        "anchor_weight_gini": 0.08875803695991635
      },
      "folio": {
        "n_examples": 203,
        "n_choices": 3,
        "random_baseline": 0.3333333333333333,
        "accuracy": 0.3497536945812808,
        "lift_over_random": 0.01642036124794749,
        "anchor_entropy_mean": 2.7601206302642822,
        "anchor_entropy_std": 0.0013506027171388268,
        "anchor_entropy_ratio": 0.9955030863844001,
        "max_anchor_weight_mean": 0.08183176070451736,
        "max_anchor_weight_std": 0.001575832488015294,
        "per_anchor_mean_weight": [
          0.05810343846678734,
          0.05722038820385933,
          0.060930974781513214,
          0.05430450290441513,
          0.06309366226196289,
          0.04809480160474777,
          0.06964443624019623,
          0.07202044129371643,
          0.06465324014425278,
          0.04449735954403877,
          0.059571754187345505,
          0.07302044332027435,
          0.06367884576320648,
          0.07537099719047546,
          0.05396297201514244,
          0.08183176070451736
        ],
        "anchor_weight_gini": 0.08861773833632469
      }
    },
    "7": {
      "gsm8k": {
        "n_examples": 1319,
        "n_choices": 4,
        "random_baseline": 0.25,
        "accuracy": 0.5064442759666414,
        "lift_over_random": 0.25644427596664143,
        "anchor_entropy_mean": 2.765568256378174,
        "anchor_entropy_std": 0.0026685234624892473,
        "anchor_entropy_ratio": 0.9974679021791822,
        "max_anchor_weight_mean": 0.07806935906410217,
        "max_anchor_weight_std": 0.004030676558613777,
        "per_anchor_mean_weight": [
          0.06390887498855591,
          0.05902969464659691,
          0.06531047821044922,
          0.06015338748693466,
          0.05917176231741905,
          0.06303583085536957,
          0.06340927630662918,
          0.0681726485490799,
          0.06275607645511627,
          0.06051626428961754,
          0.06507079303264618,
          0.06589375436306,
          0.06078727915883064,
          0.0631755143404007,
          0.06254524737596512,
          0.05706310644745827
        ],
        "anchor_weight_gini": 0.02541794115677476
      },
      "arc_challenge": {
        "n_examples": 1172,
        "n_choices": 4,
        "random_baseline": 0.25,
        "accuracy": 0.295221843003413,
        "lift_over_random": 0.045221843003412976,
        "anchor_entropy_mean": 2.7628281116485596,
        "anchor_entropy_std": 0.0015932188834995031,
        "anchor_entropy_ratio": 0.9964796038759991,
        "max_anchor_weight_mean": 0.08221708983182907,
        "max_anchor_weight_std": 0.001992042874917388,
        "per_anchor_mean_weight": [
          0.06139210984110832,
          0.05929260700941086,
          0.06141992658376694,
          0.05644705146551132,
          0.05836101993918419,
          0.061064787209033966,
          0.08215823769569397,
          0.049843400716781616,
          0.05882401764392853,
          0.06077342480421066,
          0.07743742316961288,
          0.057269491255283356,
          0.07009238004684448,
          0.07248708605766296,
          0.04941319674253464,
          0.06372382491827011
        ],
        "anchor_weight_gini": 0.07492831768468022
      },
      "strategyqa": {
        "n_examples": 1603,
        "n_choices": 2,
        "random_baseline": 0.5,
        "accuracy": 0.4978165938864629,
        "lift_over_random": -0.002183406113537123,
        "anchor_entropy_mean": 2.7639920711517334,
        "anchor_entropy_std": 0.001534555689431727,
        "anchor_entropy_ratio": 0.9968994135267552,
        "max_anchor_weight_mean": 0.08066899329423904,
        "max_anchor_weight_std": 0.0021029002964496613,
        "per_anchor_mean_weight": [
          0.06232985854148865,
          0.05887368693947792,
          0.06127419322729111,
          0.057587455958127975,
          0.05862993001937866,
          0.06067177280783653,
          0.08064417541027069,
          0.05064583942294121,
          0.058548301458358765,
          0.060944654047489166,
          0.07616430521011353,
          0.05866006016731262,
          0.06972981244325638,
          0.07258044183254242,
          0.049834128469228745,
          0.06288138031959534
        ],
        "anchor_weight_gini": 0.0696894177235663
      },
      "folio": {
        "n_examples": 203,
        "n_choices": 3,
        "random_baseline": 0.3333333333333333,
        "accuracy": 0.3448275862068966,
        "lift_over_random": 0.01149425287356326,
        "anchor_entropy_mean": 2.763610601425171,
        "anchor_entropy_std": 0.0016399883897975087,
        "anchor_entropy_ratio": 0.996761827406065,
        "max_anchor_weight_mean": 0.08067897707223892,
        "max_anchor_weight_std": 0.0018621747149154544,
        "per_anchor_mean_weight": [
          0.06178983673453331,
          0.058894477784633636,
          0.06134221702814102,
          0.05708526447415352,
          0.05847177654504776,
          0.06041194498538971,
          0.08064897358417511,
          0.05024287849664688,
          0.05947547033429146,
          0.06085624545812607,
          0.07724716514348984,
          0.05788842588663101,
          0.07021895796060562,
          0.07184428721666336,
          0.04978415369987488,
          0.06379790604114532
        ],
        "anchor_weight_gini": 0.07157224928960204
      }
    }
  },
  "aggregate": {
    "gsm8k": {
      "n_examples": 1319,
      "n_choices": 4,
      "random_baseline": 0.25,
      "per_seed_acc": {
        "42": 0.4450341167551175,
        "123": 0.5049279757391963,
        "7": 0.5064442759666414
      },
      "mean_acc": 0.48546878948698513,
      "std_acc": 0.035025660033679094,
      "mean_lift": 0.2354687894869851,
      "std_lift": 0.03502566003367909,
      "mean_entropy_ratio": 0.9968783169882495,
      "std_entropy_ratio": 0.0005149098696171216,
      "mean_max_anchor_weight": 0.07875261455774307,
      "delta_vs_e10": 0.011468789486985154
    },
    "arc_challenge": {
      "n_examples": 1172,
      "n_choices": 4,
      "random_baseline": 0.25,
      "per_seed_acc": {
        "42": 0.28668941979522183,
        "123": 0.28668941979522183,
        "7": 0.295221843003413
      },
      "mean_acc": 0.28953356086461884,
      "std_acc": 0.004926196836088966,
      "mean_lift": 0.03953356086461888,
      "std_lift": 0.004926196836088966,
      "mean_entropy_ratio": 0.9958028234810788,
      "std_entropy_ratio": 0.0006083285541017238,
      "mean_max_anchor_weight": 0.081115427116553,
      "delta_vs_e10": 0.008533560864618817
    },
    "strategyqa": {
      "n_examples": 1603,
      "n_choices": 2,
      "random_baseline": 0.5,
      "per_seed_acc": {
        "42": 0.495321272613849,
        "123": 0.46350592638802246,
        "7": 0.4978165938864629
      },
      "mean_acc": 0.48554793096277815,
      "std_acc": 0.019129666262602485,
      "mean_lift": -0.014452069037221885,
      "std_lift": 0.019129666262602485,
      "mean_entropy_ratio": 0.9960476407845821,
      "std_entropy_ratio": 0.0007458998666483434,
      "mean_max_anchor_weight": 0.08025551587343216,
      "delta_vs_e10": -0.0064520690372218414
    },
    "folio": {
      "n_examples": 203,
      "n_choices": 3,
      "random_baseline": 0.3333333333333333,
      "per_seed_acc": {
        "42": 0.35467980295566504,
        "123": 0.3497536945812808,
        "7": 0.3448275862068966
      },
      "mean_acc": 0.34975369458128086,
      "std_acc": 0.0049261083743842304,
      "mean_lift": 0.01642036124794749,
      "std_lift": 0.0049261083743842304,
      "mean_entropy_ratio": 0.99601831774261,
      "std_entropy_ratio": 0.0006596896834040501,
      "mean_max_anchor_weight": 0.08028015494346619,
      "delta_vs_e10": 0.019753694581280845
    }
  },
  "diagnostics": {
    "42": {
      "anchor": {
        "anchor_norm_mean": 1.0075831413269043,
        "anchor_norm_std": 0.009634328074753284,
        "anchor_cosine_sim_mean": -0.017245708033442497,
        "anchor_cosine_sim_max": 0.7308025360107422,
        "proj_weight_norm": 8.585625648498535
      },
      "perturbation": {
        "mean_perturbation": 0.16996399778872728,
        "std_perturbation": 0.004394516479822966,
        "max_perturbation": 0.18036721646785736,
        "min_perturbation": 0.16283981502056122,
        "per_anchor": [
          0.16283981502056122,
          0.17052903771400452,
          0.1691567599773407,
          0.17084400355815887,
          0.16859997808933258,
          0.16609124839305878,
          0.16908831894397736,
          0.18036721646785736,
          0.16881415247917175,
          0.16691072285175323,
          0.1799873262643814,
          0.17069484293460846,
          0.17083165049552917,
          0.16977980732917786,
          0.16578492522239685,
          0.16910415887832642
        ]
      }
    },
    "123": {
      "anchor": {
        "anchor_norm_mean": 1.0015690326690674,
        "anchor_norm_std": 0.0033452583011239767,
        "anchor_cosine_sim_mean": 0.036125145852565765,
        "anchor_cosine_sim_max": 0.7880854606628418,
        "proj_weight_norm": 8.734228134155273
      },
      "perturbation": {
        "mean_perturbation": 0.15729621425271034,
        "std_perturbation": 0.004137153136333621,
        "max_perturbation": 0.16402865946292877,
        "min_perturbation": 0.14871428906917572,
        "per_anchor": [
          0.1627998650074005,
          0.1607315093278885,
          0.15485265851020813,
          0.157671257853508,
          0.1550443470478058,
          0.1601971834897995,
          0.15974034368991852,
          0.15394145250320435,
          0.15821929275989532,
          0.15299193561077118,
          0.1626805067062378,
          0.14871428906917572,
          0.15704979002475739,
          0.15581350028514862,
          0.1522628366947174,
          0.16402865946292877
        ]
      }
    },
    "7": {
      "anchor": {
        "anchor_norm_mean": 1.0040311813354492,
        "anchor_norm_std": 0.006708778440952301,
        "anchor_cosine_sim_mean": -0.011481989175081253,
        "anchor_cosine_sim_max": 0.757015585899353,
        "proj_weight_norm": 8.713212966918945
      },
      "perturbation": {
        "mean_perturbation": 0.15918541327118874,
        "std_perturbation": 0.00410608370193127,
        "max_perturbation": 0.16572080552577972,
        "min_perturbation": 0.15103037655353546,
        "per_anchor": [
          0.1599748730659485,
          0.15998655557632446,
          0.1632637232542038,
          0.16323064267635345,
          0.15426254272460938,
          0.1577930748462677,
          0.16213154792785645,
          0.16066280007362366,
          0.16103717684745789,
          0.1522742211818695,
          0.15942412614822388,
          0.16358138620853424,
          0.15729071199893951,
          0.16572080552577972,
          0.15103037655353546,
          0.1553020477294922
        ]
      }
    }
  },
  "verification": {
    "any_entropy_below_0.95": false,
    "per_benchmark_entropy": {
      "gsm8k": 0.9968783169882495,
      "arc_challenge": 0.9958028234810788,
      "strategyqa": 0.9960476407845821,
      "folio": 0.99601831774261
    }
  },
  "timestamp": "2026-02-24 23:40:12",
  "elapsed_seconds": 152.7329616546631
}